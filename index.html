<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USDT Trading</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="logo.png" type="image/x-icon">
</head>
<body>
    <div class="app-container">
        <div class="filter-panel" id="filterPanel">
            <div class="filter-title">B·ªô L·ªçc</div>

            <div class="filter-group">
                <label for="maxResults">Gi·ªõi h·∫°n k·∫øt qu·∫£ (0: kh√¥ng gi·ªõi h·∫°n):</label>
                <input type="number" id="maxResults" class="input-field" value="0" min="0" max="500">
            </div>

            <div class="exchange-section">
                <div class="exchange-item" id="binance-item">
                    <input type="checkbox" class="exchange-checkbox" id="binance">
                    <span class="exchange-name">Binance</span>
                    <select class="candle-interval-select" id="binanceCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
                <div class="exchange-item" id="okx-item">
                    <input type="checkbox" class="exchange-checkbox" id="okx">
                    <span class="exchange-name">OKX</span>
                    <select class="candle-interval-select" id="okxCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
                <div class="exchange-item" id="huobi-item">
                    <input type="checkbox" class="exchange-checkbox" id="huobi">
                    <span class="exchange-name">Huobi</span>
                    <select class="candle-interval-select" id="huobiCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
                <div class="exchange-item" id="gate-item">
                    <input type="checkbox" class="exchange-checkbox" id="gate">
                    <span class="exchange-name">Gate</span>
                    <select class="candle-interval-select" id="gateCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
                <div class="exchange-item" id="mexc-item">
                    <input type="checkbox" class="exchange-checkbox" id="mexc">
                    <span class="exchange-name">MEXC</span>
                    <select class="candle-interval-select" id="mexcCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
                <div class="exchange-item" id="bybit-item">
                    <input type="checkbox" class="exchange-checkbox" id="bybit">
                    <span class="exchange-name">Bybit</span>
                    <select class="candle-interval-select" id="bybitCandleInterval" disabled>
                        <!-- Options will be dynamically populated -->
                    </select>
                </div>
            </div>

            <div class="filter-group">
                <label for="numberOfCandles">S·ªë l∆∞·ª£ng n·∫øn:</label>
                <input type="number" id="numberOfCandles" class="input-field" value="6" min="1">
            </div>
            <div class="filter-group">
                <label for="volumePeriods">Chu k·ª≥ trung b√¨nh kh·ªëi l∆∞·ª£ng:</label>
                <input type="number" id="volumePeriods" class="input-field" value="20" min="1" max="100">
            </div>

            <div class="exclusion-section">
                <div class="exclusion-item">
                    <input type="checkbox" class="exclusion-checkbox" id="excludeLeveraged" checked>
                    <span>Lo·∫°i tr·ª´ Token ƒê√≤n b·∫©y</span>
                </div>
                <div class="exclusion-item">
                    <input type="checkbox" class="exclusion-checkbox" id="excludeFutures" checked>
                    <span>Lo·∫°i tr·ª´ Futures</span>
                </div>
            </div>

            <div class="candle-section">
                <div class="candle-title">ƒêi·ªÅu Ki·ªán N·∫øn</div>
                
                <div class="condition-radio-group">
                    <div class="radio-item">
                        <input type="radio" class="radio-input" id="condition1" name="candleCondition" value="body" checked>
                        <div>
                            <label class="radio-label" for="condition1">ƒêi·ªÅu ki·ªán 1: Th√¢n n·∫øn < (N)%</label>
                            <div class="radio-description">|Gi√° ƒë√≥ng - Gi√° m·ªü| / (Gi√° tr·∫ßn - Gi√° s√†n)</div>
                        </div>
                    </div>
                    <div class="radio-item">
                        <input type="radio" class="radio-input" id="condition2" name="candleCondition" value="priceChange">
                        <div>
                            <label class="radio-label" for="condition2">ƒêi·ªÅu ki·ªán 2: Thay ƒë·ªïi gi√° < (N)%</label>
                            <div class="radio-description">|Gi√° ƒë√≥ng - Gi√° m·ªü| / Gi√° m·ªü</div>
                        </div>
                    </div>
                </div>

                <div class="filter-group">
                    <label for="conditionValue">Gi√° tr·ªã ƒëi·ªÅu ki·ªán (N):</label>
                    <input type="number" class="input-field" id="conditionValue" value="15" min="1" max="100" step="0.1">
                </div>
            </div>
            
            <div class="button-group">
                <button class="scan-button" id="scanButton">L·ªçc d·ªØ li·ªáu th·ªã tr∆∞·ªùng</button>
            </div>
        </div>

        <div class="results-area" id="resultsArea">
            <!-- Initial Content - displayed when no scan is actijsve -->
            <div id="initialContent" class="initial-display">
                <h2>Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi USDT Trading!</h2>
                <p>C√¥ng c·ª• n√†y gi√∫p b·∫°n t√¨m ki·∫øm c√°c c·∫∑p giao d·ªãch ti·ªÅm nƒÉng tr√™n nhi·ªÅu s√†n ti·ªÅn ƒëi·ªán t·ª≠ d·ª±a tr√™n c√°c ƒëi·ªÅu ki·ªán n·∫øn v√† kh·ªëi l∆∞·ª£ng t√πy ch·ªânh.</p>
                <p>Ch·ªçn c√°c s√†n giao d·ªãch, thi·∫øt l·∫≠p ƒëi·ªÅu ki·ªán c·ªßa b·∫°n ·ªü b·∫£ng ƒëi·ªÅu khi·ªÉn b√™n tr√°i, v√† nh·∫•n "B·∫Øt ƒë·∫ßu qu√©t" ƒë·ªÉ t√¨m c√°c c∆° h·ªôi giao d·ªãch m·ªõi!</p>
            </div>

            <div class="loading hidden" id="loading">
                <h2>üîç ƒêang qu√©t th·ªã tr∆∞·ªùng...</h2>
                <p>Vui l√≤ng ch·ªù trong khi ch√∫ng t√¥i ph√¢n t√≠ch d·ªØ li·ªáu...</p>
                
                <!-- Progress Container -->
                <div class="progress-container" id="progressContainer">
                    <div class="progress-header">
                        <div class="progress-title">Ti·∫øn tr√¨nh qu√©t</div>
                        <div class="progress-status" id="progressStatus">Chu·∫©n b·ªã...</div>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                        <!-- <div class="progress-text" id="progressText">0%</div> -->
                    </div>
                    
                    <div class="progress-details" id="progressDetails">
                        <!-- Progress items will be added here -->
                    </div>
                </div>
            </div>
            
            <h2 id="resultsTitle" class="hidden">üìä K·∫øt qu·∫£ qu√©t th·ªã tr∆∞·ªùng</h2>
            <table class="results-table hidden" id="resultsTable">
                <thead>
                    <tr>
                        <th>S√†n</th>
                        <th>C·∫∑p</th>
                        <th>Hi·ªán t·∫°i</th>
                        <th>Cao</th>
                        <th>Th·∫•p</th>
                        <th>24h</th>
                        <th>Xem</th>
                    </tr>
                </thead>
                <tbody id="resultsBody">
                </tbody>
            </table>

            <!-- New Error Message Container -->
            <div id="errorMessageContainer" class="error-message hidden">
                <h3>‚ö†Ô∏è ƒê√£ x·∫£y ra l·ªói trong qu√° tr√¨nh qu√©t!</h3>
                <p id="errorMessageDetail">Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi internet ho·∫∑c th·ª≠ l·∫°i sau.</p>
            </div>

            <div class="copyright-info">
                <p>&copy; <span id="currentYear">1999</span> USDT Trading. From Bac Ninh With Love.</p>
            </div>
        </div>
    </div>

    <!-- Filter Toggle Button for Mobile -->
    <button class="filter-toggle-button" id="filterToggleButton">B·ªô L·ªçc</button>

    <!-- Chart Modal -->
    <div class="chart-modal" id="chartModal">
        <div class="chart-container">
            <div class="chart-header">
                <div class="chart-title" id="chartTitle">Bi·ªÉu ƒë·ªì n·∫øn</div>
                <button class="close-chart" id="closeChart">‚úï</button>
            </div>
            
            <div class="chart-info" id="chartInfo">
                <span>Gi√° hi·ªán t·∫°i: <span id="chartCurrentPrice">--</span></span>
                <span>M·ªü: <span id="chartOpen">--</span></span>
                <span>Cao: <span id="chartHigh">--</span></span>
                <span>Th·∫•p: <span id="chartLow">--</span></span>
                <span>ƒê√≥ng: <span id="chartClose">--</span></span>
                <span>Bi·∫øn ƒë·ªông: <span id="chartChange">--</span></span>
                <span>Bi√™n ƒë·ªô: <span id="chartRange">--</span></span>
                <span>MA(7): <span id="chartSma7">--</span></span>
                <span>MA(25): <span id="chartSma25">--</span></span>
                <span>MA(99): <span id="chartSma99">--</span></span>
                <span>Vol (<span id="chartBaseAsset">--</span>): <span id="chartVolumeBase">--</span></span>
                <span>Vol (USDT): <span id="chartVolumeQuote">--</span></span>
            </div>
            
            <div class="candlestick-chart" id="candlestickChart">
                <!-- Chart will be drawn here -->
            </div>

        </div>
    </div>

    <!-- Toast Notifications Container -->
    <div id="toastContainer"></div>
    
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const currentYearSpan = document.getElementById('currentYear');
            if (currentYearSpan) {
                currentYearSpan.textContent = new Date().getFullYear();
            }

            // Mobile filter toggle
            const filterPanel = document.getElementById('filterPanel');
            const filterToggleButton = document.getElementById('filterToggleButton');

            if (filterToggleButton && filterPanel) {
                filterToggleButton.addEventListener('click', () => {
                    filterPanel.classList.toggle('show-on-mobile'); // Toggle this class to show/hide
                });

                // Adjust filter panel visibility on window resize (e.g., rotating phone)
                window.addEventListener('resize', () => {
                    if (window.innerWidth > 768) {
                        filterPanel.classList.remove('show-on-mobile'); // Remove show class on desktop
                    } else {
                        // On mobile, if it was not explicitly shown by toggle, ensure it's hidden.
                        // Otherwise, if `show-on-mobile` is present, it stays visible.
                        // No need to add a 'hidden' class now, as default mobile state is hidden by transform.
                    }
                });
            }
        });
    </script>
</body>
</html>